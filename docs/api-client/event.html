<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Event</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Apisearch client - Event object">
    <meta name="author" content="Apisearch team">
    <meta name="keywords" content="Apisearch, Elasticsearch search engine, fast search demo, Apisearch official website">

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="57x57" href="http://apisearch.io/public/images/favicons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="http://apisearch.io/public/images/favicons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://apisearch.io/public/images/favicons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="http://apisearch.io/public/images/favicons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://apisearch.io/public/images/favicons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="http://apisearch.io/public/images/favicons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="http://apisearch.io/public/images/favicons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="http://apisearch.io/public/images/favicons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="http://apisearch.io/public/images/favicons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="http://apisearch.io/public/images/favicons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="http://apisearch.io/public/images/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="http://apisearch.io/public/images/favicons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="http://apisearch.io/public/images/favicons/favicon-16x16.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="http://apisearch.io/public/images/favicons/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!-- Styles -->
    <link rel="stylesheet" href="./../assets/css/docs.css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
          rel="stylesheet"
          integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN"
          crossorigin="anonymous"
    ></head>
<body>
    <!-- Header -->
    <header>
        <nav class="c-navbar navbar navbar-expand-md fixed-top">
            <div class="c-navbar__main row">
                <!-- Brand -->
                <div class="c-navbar__brandWrapper col-2 col-sm-4 col-md-3 col-lg-2">
                    <a class="c-navbar__brand navbar-brand" href="/docs">
                        <img src="http://apisearch.io/public/images/favicons/favicon-32x32.png"
                             class="d-inline-block align-top"
                             alt="Apisearch logo">
                        <img src="http://apisearch.io/public/images/logo-.png"
                             class="d-none d-sm-inline-block"
                             height="15"
                             alt="Logo Apisearch">
                    </a>
                </div>
                <!-- /Brand -->

                <!-- Search -->
                <div class="c-search col-8 col-sm-8 col-md-9 col-lg-10 ml-md-auto">
                    <i class="c-search__searchIcon fa fa-search"
                       aria-hidden="true"></i>

                    <!-- Apisearch target -->
                    <div class="c-search__wrapper" id="searchInput"></div>
                </div>
                <!-- /Search -->

                <!-- Menu burger -->
                <div class="col-2 d-sm-none">
                    <button class="c-navbar__burger navbar-toggler">
                        <svg xmlns="http://www.w3.org/2000/svg"
                             id="burgerSidebarMenu"
                             viewBox="0 0 30 30"
                             width="30"
                             height="30"
                             focusable="false"
                        >
                            <title>Menu</title>
                            <path stroke="#54edc0"
                                  stroke-width="2"
                                  stroke-linecap="round"
                                  stroke-miterlimit="10"
                                  d="M4 7h22M4 15h22M4 23h22"
                            ></path>
                        </svg>
                    </button>
                </div>
                <!-- /Menu burger -->
            </div>
        </nav>

        <!-- submenu -->
        <div class="c-navbar__bottom">
            <div class="row">
                <div class="d-none d-sm-block col-sm-6">
                    <!-- submenu -->
                    <nav class="c-breadcrumb" aria-label="breadcrumb" role="navigation">
                        <ol class="c-breadcrumb__list breadcrumb">
                            <li class="c-breadcrumb__item breadcrumb-item"><a href="#">Apisearch docs</a></li>
                                <li class="c-breadcrumb__item breadcrumb-item"><a href="#">API Client</a></li>
                            <li class="c-breadcrumb__item--active breadcrumb-item active" aria-current="page">Event</li>
                        </ol>
                    </nav>
                    <!-- /submenu -->
                </div>
                <div class="col-12 col-sm-6">
                    <!-- language selector -->
                    <nav class="c-languageSelector">
                        <ol class="c-languageSelector__list">
                                <li class="c-languageSelector__item">
                                    <span data-lang="php"
                                          class="c-languageSelector__link">
                                        php
                                    </span>
                                </li>
                        </ol>
                    </nav>
                    <!-- /language selector -->
                </div>
            </div>
        </div>
        <!-- /submenu -->
    </header>    <!-- /Header -->

    <!-- Search result -->
    <div id="searchResult" class="c-search__result d-none">
        <!-- Overlay -->
        <div class="c-search__resultOverlay"></div>

        <!-- Result container -->
        <div class="container-fluid">
            <div class="row">
                <!-- Content -->
                <div class="col-sm-12">
                    <div class="c-search__resultBlock">
                        <div id="topicsSearchResult"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pagination
        <div id="paginationSearch"></div>
        -->
    </div>    <!-- /Search result -->

    <!-- Main -->
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div id="sidebarMenu"
                 class="c-sidebar sidebar col-sm-4 col-md-3 col-lg-2 d-none d-sm-block"
            >
                <ul class="c-sidebar__nav nav nav-pills flex-column">
                        <li class="c-sidebar__navItem nav-item">
                            <a class="c-sidebar__navLink c-sidebar__navLink--title nav-link"
                               href="/docs/first-steps.html"
                            >
                                <i class="fa fa-angle-right" aria-hidden="true"></i>
                                First Steps
                            </a>
                        </li>

                        <li class="c-sidebar__navItem nav-item">
                            <a class="c-sidebar__navLink c-sidebar__navLink--title nav-link"
                               href="/docs/api-client.html"
                            >
                                <i class="fa fa-angle-right" aria-hidden="true"></i>
                                API Client
                            </a>
                        </li>

                            <ul class="c-sidebar__nav c-sidebar__nav--sub-1 nav nav-pills flex-column">
                                    <li class="c-sidebar__navItem--sub-1 nav-item">
                                        <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                           href="/docs/api-client/index.html"
                                        >
                                            Index
                                        </a>
                                    </li>
                                    <li class="c-sidebar__navItem--sub-1 nav-item">
                                        <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                           href="/docs/api-client/model.html"
                                        >
                                            Model
                                        </a>
                                    </li>
                                    <li class="c-sidebar__navItem--sub-1 nav-item">
                                        <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                           href="/docs/api-client/query.html"
                                        >
                                            Query
                                        </a>
                                    </li>
                                    <li class="c-sidebar__navItem--sub-1 nav-item">
                                        <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                           href="/docs/api-client/result.html"
                                        >
                                            Result
                                        </a>
                                    </li>
                                    <li class="c-sidebar__navItem--sub-1 nav-item">
                                        <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                           href="/docs/api-client/repository.html"
                                        >
                                            Repository
                                        </a>
                                    </li>
                                    <li class="c-sidebar__navItem--sub-1 nav-item">
                                        <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                           href="/docs/api-client/event.html"
                                        >
                                            Event
                                        </a>
                                    </li>
                            </ul>
                        <li class="c-sidebar__navItem nav-item">
                            <a class="c-sidebar__navLink c-sidebar__navLink--title nav-link"
                               href="/docs/integrations.html"
                            >
                                <i class="fa fa-angle-right" aria-hidden="true"></i>
                                Integrations
                            </a>
                        </li>

                            <ul class="c-sidebar__nav c-sidebar__nav--sub-1 nav nav-pills flex-column">
                                    <li class="c-sidebar__navItem--sub-1 nav-item">
                                        <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                           href="/docs/integrations/symfony-bundle.html"
                                        >
                                            Symfony Bundle
                                        </a>
                                    </li>
                            </ul>
                        <li class="c-sidebar__navItem nav-item">
                            <a class="c-sidebar__navLink c-sidebar__navLink--title nav-link"
                               href="/docs/ui.html"
                            >
                                <i class="fa fa-angle-right" aria-hidden="true"></i>
                                UI
                            </a>
                        </li>

                            <ul class="c-sidebar__nav c-sidebar__nav--sub-1 nav nav-pills flex-column">
                                    <li class="c-sidebar__navItem--sub-1 nav-item">
                                        <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                           href="/docs/ui/widgets.html"
                                        >
                                            Widgets
                                        </a>
                                    </li>
                                    <li class="c-sidebar__navItem--sub-1 nav-item">
                                        <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                           href="/docs/ui/examples.html"
                                        >
                                            Examples
                                        </a>
                                    </li>
                            </ul>
                </ul>
            </div>            <!-- Sidebar -->

            <!-- Main -->
            <main class="col-sm-8 col-md-9 col-lg-8 ml-sm-auto mr-lg-auto pt-3" role="main">
                <section class="c-content">
                    <!-- Content -->
                    <h1 id="event"><a name="event" class="fa fa-link" href="#"></a>Event</h1>
<p>Do you remember that each Repository interaction creates a simple Event? That is
because we track every single movement you make to our servers. And this is good
because then you can make some external conclusions by retrieving, checking and
manipulating these events.</p>
<h2 id="event-repository"><a name="event-repository" class="fa fa-link" href="#"></a>Event Repository</h2>
<p>So let’s take a look at how you can retrieve all these events and check as many
metrics as you want. With this example, we get all first 100 Queries done from
yesterday at same hour until now.</p>
<pre><code class="language-php">$eventRepository = <span class="hljs-keyword">new</span> EventRepository(
    <span class="hljs-keyword">new</span> GuzzleClient(<span class="hljs-string">'http://api.ourhost.xyz:1234'</span>)
);

$repository-&gt;all(
    <span class="hljs-string">'mysecretkey'</span>,
    <span class="hljs-string">'QueryWasMade'</span>,
    (time() - (<span class="hljs-number">24</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span>)),
    time(),
    <span class="hljs-number">100</span>,
    <span class="hljs-number">0</span>
);
</code></pre>
<p>You can check all the Event types after some chapters.</p>
<h2 id="event-object"><a name="event-object" class="fa fa-link" href="#"></a>Event Object</h2>
<p>Each EventRepository call will return an array of Event instances. Each one of
them is a very simple class that has everything involved in the event itself.</p>
<pre><code class="language-php"><span class="hljs-comment">/**
 * Class Event.
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Event</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">HttpTransportable</span>
</span>{
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@var</span> int
     *
     * Id
     */</span>
    <span class="hljs-keyword">private</span> $id;

    <span class="hljs-comment">/**
     * var string.
     *
     * Consistency hash
     */</span>
    <span class="hljs-keyword">private</span> $consistencyHash;

    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@var</span> string
     *
     * name
     */</span>
    <span class="hljs-keyword">private</span> $name;

    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@var</span> string
     *
     * Key
     */</span>
    <span class="hljs-keyword">private</span> $key;

    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@var</span> string
     *
     * Payload
     */</span>
    <span class="hljs-keyword">private</span> $payload;

    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@var</span> int
     *
     * Occurred on
     */</span>
    <span class="hljs-keyword">private</span> $occurredOn;
}
</code></pre>
<p>When retrieving the payload, you will receive a json encoded array, so make sure
you decode it if you want to digg into the event content.</p>
<pre><code class="language-php">$payload = json_decode($event-&gt;getPayload(), <span class="hljs-keyword">true</span>);
</code></pre>
<h2 id="event-types"><a name="event-types" class="fa fa-link" href="#"></a>Event types</h2>
<p>Each type of action against your data set means a different event. To be honest,
once you have all the events sorted over the time, you should be able to
regenerate your index from the first time you generated it.</p>
<p>We can divide the events in two big groups</p>
<h3 id="write-online-events"><a name="write-online-events" class="fa fa-link" href="#"></a>Write online events</h3>
<p>These events will only write elements in your index. This means that no response
is expected at all.</p>
<ul>
<li>IndexWasReset : You reset your index</li>
<li>ItemsWereIndexed : You index some items</li>
<li>ItemsWereDeleted : You delete some items</li>
</ul>
<p>These events will contain all the data inside your specification. For example.
You will find the item content inside each ItemsWereIndexed events, so if in the
future you need to rewrite the entire index from the beginning, you will notice
that you can check items values from the past.</p>
<h3 id="readonly-events"><a name="readonly-events" class="fa fa-link" href="#"></a>Readonly events</h3>
<p>These events don’t cause any index change. It is not really important the order
over the time, only for statistics purposes.</p>
<ul>
<li>QueryWasMade : Each query is made. Because you can check the items content at
the time the query was made by checking the index status using the write only
events, the result will only contain the Items ids instead of all the content.</li>
</ul>

                    <!-- /Content -->

                    <hr>
                    <a class="c-content__editOnGithub"
                       target="_blank"
                       href="https://github.com/apisearch-io/docs/tree/master/src/content/api-client/event.md">
                        <i class="fa fa-github" aria-hidden="true"></i>
                        Edit this page!
                    </a>
                </section>
            </main>
            <!-- /Main -->

            <!-- Toc here -->
            <div class="c-toc col-lg-2 d-none d-lg-block">
                <ul class="c-toc__nav nav nav-pills flex-column">
                    <li class="c-toc__navItem c-toc__navItem--1 nav-item">
                        <a class="c-toc__navLink c-toc__navLink--title nav-link"
                           href="#event"
                        >
                            Event
                        </a>
                    </li>
                    <li class="c-toc__navItem c-toc__navItem--2 nav-item">
                        <a class="c-toc__navLink c-toc__navLink--title nav-link"
                           href="#event-repository"
                        >
                            Event Repository
                        </a>
                    </li>
                    <li class="c-toc__navItem c-toc__navItem--2 nav-item">
                        <a class="c-toc__navLink c-toc__navLink--title nav-link"
                           href="#event-object"
                        >
                            Event Object
                        </a>
                    </li>
                    <li class="c-toc__navItem c-toc__navItem--2 nav-item">
                        <a class="c-toc__navLink c-toc__navLink--title nav-link"
                           href="#event-types"
                        >
                            Event types
                        </a>
                    </li>
                    <li class="c-toc__navItem c-toc__navItem--3 nav-item">
                        <a class="c-toc__navLink c-toc__navLink--title nav-link"
                           href="#write-online-events"
                        >
                            Write online events
                        </a>
                    </li>
                    <li class="c-toc__navItem c-toc__navItem--3 nav-item">
                        <a class="c-toc__navLink c-toc__navLink--title nav-link"
                           href="#readonly-events"
                        >
                            Readonly events
                        </a>
                    </li>
                </ul>
            </div>
            <!-- End toc -->

            <!-- Footer -->
            <footer class="c-footer col-sm-9 ml-sm-auto col-md-10 pt-3">
                <nav class="navbar">
                    <span class="c-footer__logoWrapper navbar-text text-center d-block">
                        <img src="http://apisearch.io/public/images/favicons/favicon-32x32.png"
                             class="c-footer__logo c-footer__logo--top d-block align-top"
                             alt="Apisearch logo"
                        >
                        <img src="http://apisearch.io/public/images/logo-.png"
                             height="16"
                             class="c-footer__logo c-footer__logo--bottom d-block align-top"
                             alt="Logo Apisearch"
                        >
                    </span>
                    <ul class="c-footer__linksWrapper navbar-nav">
                        <li class="c-footer__linkItem nav-item">
                            <a href="https://github.io/apisearch-io/"
                               target="_blank"
                               class="c-footer__link c-footer__link--icon nav-link"
                            >
                                <i class="fa fa-github" aria-hidden="true"></i>
                            </a>
                        </li>
                        <li class="c-footer__linkItem nav-item">
                            <a href="https://twitter.com/apisearch_io"
                               target="_blank"
                               class="c-footer__link c-footer__link--icon nav-link"
                            >
                                <i class="fa fa-twitter" aria-hidden="true"></i>
                            </a>
                        </li>
                        <li class="c-footer__linkItem nav-item">
                            <a href="#linkedin"
                               target="_blank"
                               class="c-footer__link c-footer__link--icon nav-link"
                            >
                                <i class="fa fa-linkedin" aria-hidden="true"></i>
                            </a>
                        </li>
                    </ul>
                    <ul class="c-footer__linksWrapper navbar-nav">
                        <li class="c-footer__linkItem nav-item">
                            <a href="http://apisearch.io"
                               class="c-footer__link nav-link"
                            >
                                Home
                            </a>
                        </li>
                        <li class="c-footer__linkItem nav-item">
                            <a href="http://apisearch-io.github.com/docs/"
                               class="c-footer__link nav-link"
                            >
                                Docs
                            </a>
                        </li>
                        <li class="c-footer__linkItem nav-item">
                            <a href="#examples"
                               class="c-footer__link nav-link"
                            >
                                Examples
                            </a>
                        </li>
                        <li class="c-footer__linkItem nav-item">
                            <a href="mailto:hello@puntmig.com"
                               class="c-footer__link nav-link"
                            >
                                Contact
                            </a>
                        </li>
                        <li class="c-footer__linkItem nav-item">
                            <a href="#terms-and-conditions"
                               class="c-footer__link nav-link"
                            >
                                Terms & Conditions
                            </a>
                        </li>
                    </ul>
                </nav>
            </footer>            <!-- /Footer -->
        </div>
    </div>
    <!-- /Main -->

    <!-- Go up -->
    <a id="goUpButton"
       class="c-goUp d-none fa fa-angle-up"
       href="#"
       aria-hidden="true"
    ></a>
    <!-- /Go up -->

    <!-- Scripts -->
    <script src="./../assets/js/app.js"></script>
</body>
</html>