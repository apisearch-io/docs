<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Symfony - Apisearch Bundle</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Apisearch integrations - Symfony Apisearch Bundle">
    <meta name="author" content="Apisearch team">

    <!-- Custom -->
    <link rel="stylesheet" href="./../assets/css/docs.css">
    <script src="./../assets/js/app.js"></script>
</head>
<body>
    <!-- Header -->
    <header>
        <nav class="c-navbar navbar navbar-expand-md fixed-top">
            <a class="navbar-brand" href="#">
                <img src="http://apisearch.io/public/images/favicons/favicon-32x32.png"
                     class="d-inline-block align-top"
                     alt="Apisearch logo">
                <img src="http://apisearch.io/public/images/logo-.png"
                     height="15"
                     alt="Logo Apisearch">
            </a>
            <button class="navbar-toggler"
                type="button"
                data-toggle="collapse"
                data-target="#navbarCollapse"
                aria-controls="navbarCollapse"
                aria-expanded="false"
                aria-label="Toggle navigation"
            >
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarCollapse">
                <ul class="navbar-nav mr-auto">
                    <!-- Nav menu here -->
                </ul>

                <form class="form-inline mt-2 mt-md-0">
                    <input class="o-input form-control mr-sm-2"
                           type="text"
                           placeholder="Search"
                           aria-label="Search">
                </form>
            </div>
        </nav>
    </header>
    <!-- /Header -->

    <!-- Main -->
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="c-sidebar sidebar col-sm-3 col-md-2 d-none d-sm-block">
                <ul class="c-sidebar__nav nav nav-pills flex-column">
                        <li class="c-sidebar__navItem nav-item">
                            <a class="c-sidebar__navLink c-sidebar__navLink--title nav-link"
                               href="#"
                            >
                                Apisearch
                            </a>
                        </li>
                        <ul class="c-sidebar__nav nav nav-pills flex-column">
                            <li class="c-sidebar__navItem--sub-1 nav-item">
                                <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                   href="/docs/index.html">
                                    Apisearch docs
                                </a>
                            </li>
                            <li class="c-sidebar__navItem--sub-1 nav-item">
                                <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                   href="/docs/style-guide.html">
                                    Style guide
                                </a>
                            </li>
                        </ul>
                        <li class="c-sidebar__navItem nav-item">
                            <a class="c-sidebar__navLink c-sidebar__navLink--title nav-link"
                               href="#"
                            >
                                Apisearch UI
                            </a>
                        </li>
                        <ul class="c-sidebar__nav nav nav-pills flex-column">
                            <li class="c-sidebar__navItem--sub-1 nav-item">
                                <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                   href="/docs/ui/index.html">
                                    Overview
                                </a>
                            </li>
                            <li class="c-sidebar__navItem--sub-1 nav-item">
                                <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                   href="/docs/ui/install.html">
                                    Installation
                                </a>
                            </li>
                            <li class="c-sidebar__navItem--sub-1 nav-item">
                                <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                   href="/docs/ui/widgets.html">
                                    Widgets
                                </a>
                            </li>
                        </ul>
                        <li class="c-sidebar__navItem nav-item">
                            <a class="c-sidebar__navLink c-sidebar__navLink--title nav-link"
                               href="#"
                            >
                                Apisearch integration
                            </a>
                        </li>
                        <ul class="c-sidebar__nav nav nav-pills flex-column">
                            <li class="c-sidebar__navItem--sub-1 nav-item">
                                <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                   href="/docs/integration/symfony-apisearch-bundle.html">
                                    Symfony - Apisearch Bundle
                                </a>
                            </li>
                        </ul>
                        <li class="c-sidebar__navItem nav-item">
                            <a class="c-sidebar__navLink c-sidebar__navLink--title nav-link"
                               href="#"
                            >
                                Fresh start
                            </a>
                        </li>
                        <ul class="c-sidebar__nav nav nav-pills flex-column">
                            <li class="c-sidebar__navItem--sub-1 nav-item">
                                <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                   href="/docs/fresh-start/first-steps.html">
                                    First steps
                                </a>
                            </li>
                        </ul>
                        <li class="c-sidebar__navItem nav-item">
                            <a class="c-sidebar__navLink c-sidebar__navLink--title nav-link"
                               href="#"
                            >
                                Apisearch client
                            </a>
                        </li>
                        <ul class="c-sidebar__nav nav nav-pills flex-column">
                            <li class="c-sidebar__navItem--sub-1 nav-item">
                                <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                   href="/docs/client/event.html">
                                    Event
                                </a>
                            </li>
                            <li class="c-sidebar__navItem--sub-1 nav-item">
                                <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                   href="/docs/client/index.html">
                                    Index
                                </a>
                            </li>
                            <li class="c-sidebar__navItem--sub-1 nav-item">
                                <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                   href="/docs/client/model.html">
                                    Model
                                </a>
                            </li>
                            <li class="c-sidebar__navItem--sub-1 nav-item">
                                <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                   href="/docs/client/query.html">
                                    Query
                                </a>
                            </li>
                            <li class="c-sidebar__navItem--sub-1 nav-item">
                                <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                   href="/docs/client/repository.html">
                                    Repository
                                </a>
                            </li>
                            <li class="c-sidebar__navItem--sub-1 nav-item">
                                <a class="c-sidebar__navLink c-sidebar__navLink--subtitle nav-link"
                                   href="/docs/client/result.html">
                                    Result
                                </a>
                            </li>
                        </ul>
                </ul>
            </div>
            <!-- Sidebar -->

            <!-- Content -->
            <main class="col-sm-8 ml-md-auto mr-md-auto pt-3" role="main">
                <section class="c-content">
                    <h1>Event</h1>
<p>Do you remember that each Repository interaction creates a simple Event? That is
because we track every single movement you make to our servers. And this is good
because if we can know, you can know.</p>
<p>So let’s take a look at how you can retrieve all these events and check as many
metrics as you want. With this example, we get all first 100 Queries done from
yesterday at same hour until now.</p>
<pre><code class="language-php">$eventRepository = <span class="hljs-keyword">new</span> EventRepository(
    <span class="hljs-keyword">new</span> GuzzleClient(<span class="hljs-string">'http://api.ourhost.xyz:1234'</span>)
);
$repository-&gt;all(
    <span class="hljs-string">'mysecretkey'</span>,
    <span class="hljs-string">'QueryWasMade'</span>,
    (time() - (<span class="hljs-number">24</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span>)),
    time(),
    <span class="hljs-number">100</span>,
    <span class="hljs-number">0</span>
);
</code></pre>
<p>Let’s check as well all different events.</p>
<ul>
<li>IndexWasReset</li>
<li>ItemsWereIndexed</li>
<li>ItemsWereDeleted</li>
<li>QueryWasMade</li>
</ul>
<p>So, what does this endpoint return to us?</p>
<h3>Event</h3>
<p>An array of Events. And what is an event? A very simple class that has
everything we need in order to make metrics, panels and side calculations.</p>
<pre><code class="language-php"><span class="hljs-comment">/**
 * Class Event.
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Event</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">HttpTransportable</span>
</span>{
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@var</span> int
     *
     * Id
     */</span>
    <span class="hljs-keyword">private</span> $id;

    <span class="hljs-comment">/**
     * var string.
     *
     * Consistency hash
     */</span>
    <span class="hljs-keyword">private</span> $consistencyHash;

    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@var</span> string
     *
     * name
     */</span>
    <span class="hljs-keyword">private</span> $name;

    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@var</span> string
     *
     * Key
     */</span>
    <span class="hljs-keyword">private</span> $key;

    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@var</span> string
     *
     * Payload
     */</span>
    <span class="hljs-keyword">private</span> $payload;

    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@var</span> int
     *
     * Occurred on
     */</span>
    <span class="hljs-keyword">private</span> $occurredOn;
}
</code></pre>
<p>When retrieving the payload, you will receive a json encoded array, so make sure
you decode it if you want to digg into the event content.</p>
<pre><code class="language-php">$payload = json_decode($event-&gt;getPayload(), <span class="hljs-keyword">true</span>);
</code></pre>

                </section>
            </main>
            <!-- /Content -->

            <!-- Toc -->
            <div class="c-toc col-sm-3 col-md-2 d-none d-sm-block">
                <ul class="c-toc__nav nav nav-pills flex-column">
                    <li class="c-toc__navItem nav-item">
                        <a class="c-toc__navLink c-toc__navLink--title nav-link"
                           href="#"
                        >
                            HELLO
                        </a>
                    </li>
                </ul>
            </div>
            <!-- Toc -->

            <!-- Footer -->
            <footer class="c-footer col-sm-9 ml-sm-auto col-md-10 pt-3">
                <nav class="navbar">
                    <span class="navbar-text">
                        Navbar text with an inline element
                    </span>
                </nav>
            </footer>
            <!-- /Footer -->
        </div>
    </div>
    <!-- /Main -->
</body>
</html>